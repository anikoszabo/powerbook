<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 One-sample proportion | Power and Sample Size Manual</title>
  <meta name="description" content="This is a reference book for power and sample size calculations using R" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="2 One-sample proportion | Power and Sample Size Manual" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a reference book for power and sample size calculations using R" />
  <meta name="github-repo" content="anikoszabo/powerbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 One-sample proportion | Power and Sample Size Manual" />
  
  <meta name="twitter:description" content="This is a reference book for power and sample size calculations using R" />
  

<meta name="author" content="Aniko Szabo" />


<meta name="date" content="2023-01-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="one-sample-mean.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Power and Sample Size Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="part"><span><b>I Analyzing population means</b></span></li>
<li class="chapter" data-level="1" data-path="one-sample-mean.html"><a href="one-sample-mean.html"><i class="fa fa-check"></i><b>1</b> One-sample mean</a>
<ul>
<li class="chapter" data-level="1.1" data-path="one-sample-mean.html"><a href="one-sample-mean.html#example"><i class="fa fa-check"></i><b>1.1</b> Example</a></li>
<li class="chapter" data-level="1.2" data-path="one-sample-mean.html"><a href="one-sample-mean.html#data-generating-mechanism"><i class="fa fa-check"></i><b>1.2</b> Data generating mechanism</a></li>
<li class="chapter" data-level="1.3" data-path="one-sample-mean.html"><a href="one-sample-mean.html#precision-based-sample-size"><i class="fa fa-check"></i><b>1.3</b> Precision-based sample size</a></li>
<li class="chapter" data-level="1.4" data-path="one-sample-mean.html"><a href="one-sample-mean.html#power-based-sample-size"><i class="fa fa-check"></i><b>1.4</b> Power-based sample size</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="one-sample-mean.html"><a href="one-sample-mean.html#test-statistic"><i class="fa fa-check"></i><b>1.4.1</b> Test statistic</a></li>
<li class="chapter" data-level="1.4.2" data-path="one-sample-mean.html"><a href="one-sample-mean.html#power-formula"><i class="fa fa-check"></i><b>1.4.2</b> Power formula</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="one-sample-mean.html"><a href="one-sample-mean.html#getting-inputs"><i class="fa fa-check"></i><b>1.5</b> Getting inputs</a></li>
<li class="chapter" data-level="1.6" data-path="one-sample-mean.html"><a href="one-sample-mean.html#example-revisited"><i class="fa fa-check"></i><b>1.6</b> Example revisited</a></li>
<li class="chapter" data-level="1.7" data-path="one-sample-mean.html"><a href="one-sample-mean.html#simulation-study"><i class="fa fa-check"></i><b>1.7</b> Simulation study</a></li>
<li class="chapter" data-level="1.8" data-path="one-sample-mean.html"><a href="one-sample-mean.html#functions-in-r-packages"><i class="fa fa-check"></i><b>1.8</b> Functions in R packages</a></li>
</ul></li>
<li class="part"><span><b>II Analyzing population proportions</b></span></li>
<li class="chapter" data-level="2" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html"><i class="fa fa-check"></i><b>2</b> One-sample proportion</a>
<ul>
<li class="chapter" data-level="2.1" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html#example-1"><i class="fa fa-check"></i><b>2.1</b> Example</a></li>
<li class="chapter" data-level="2.2" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html#data-generating-mechanism-1"><i class="fa fa-check"></i><b>2.2</b> Data generating mechanism</a></li>
<li class="chapter" data-level="2.3" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html#precision-based-sample-size-1"><i class="fa fa-check"></i><b>2.3</b> Precision-based sample size</a></li>
<li class="chapter" data-level="2.4" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html#power-based-sample-size-1"><i class="fa fa-check"></i><b>2.4</b> Power-based sample size</a>
<ul>
<li class="chapter" data-level="" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html#test-statistic-1"><i class="fa fa-check"></i>Test statistic</a></li>
<li class="chapter" data-level="" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html#power-formula-1"><i class="fa fa-check"></i>Power formula</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html#getting-inputs-worstbest-case-scenarios"><i class="fa fa-check"></i><b>2.5</b> Getting inputs, worst/best case scenarios</a></li>
<li class="chapter" data-level="2.6" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html#example-revisited-1"><i class="fa fa-check"></i><b>2.6</b> Example revisited</a></li>
<li class="chapter" data-level="2.7" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html#simulation-study-1"><i class="fa fa-check"></i><b>2.7</b> Simulation study</a></li>
<li class="chapter" data-level="2.8" data-path="one-sample-proportion.html"><a href="one-sample-proportion.html#functions-in-r-packages-1"><i class="fa fa-check"></i><b>2.8</b> Functions in R packages</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Power and Sample Size Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="one-sample-proportion" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> One-sample proportion<a href="one-sample-proportion.html#one-sample-proportion" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="example-1" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Example<a href="one-sample-proportion.html#example-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An oncologist is developing a new treatment, and he wants to run a single arm phase II study to estimate the probability of response (partial or complete reduction in the size of the tumor) after four weeks of treatment. The current standard of care has a 30% response probability. How many subjects should he recruit?</p>
</div>
<div id="data-generating-mechanism-1" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Data generating mechanism<a href="one-sample-proportion.html#data-generating-mechanism-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Independent identically distributed variables <span class="math inline">\(X_1, \ldots, X_n \sim Bernoulli(p)\)</span> with <span class="math inline">\(p\)</span>, the event probability as the parameter of interest.</p>
<p>It will be estimated as the sample proportion <span class="math inline">\(\hat{p} = \sum_{i=1}^n X_i / n\)</span>. Inference can be based on the exact distribution of <span class="math inline">\(X = \sum_{i=1}^n X_i \sim Binom(n,p)\)</span> or the asymptotic distribution of <span class="math inline">\(\hat{p} \sim N(p, \frac{p(1-p)}{n})\)</span>.</p>
</div>
<div id="precision-based-sample-size-1" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Precision-based sample size<a href="one-sample-proportion.html#precision-based-sample-size-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The precision-based calculations are based on the standard error of <span class="math inline">\(\hat{p}\)</span>:
<span class="math display">\[\begin{equation}
SE(\hat{p}) = \sqrt\frac{p(1-p)}{n}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="one-sample-proportion.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Calculate standard error for given sample size, or vice versa. Exactly one of &#39;n&#39; and &#39;se&#39; has to be NULL</span></span>
<span id="cb1-2"><a href="one-sample-proportion.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; p - expected event probability</span></span>
<span id="cb1-3"><a href="one-sample-proportion.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n - sample size</span></span>
<span id="cb1-4"><a href="one-sample-proportion.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; se - standard error of estimated probability</span></span>
<span id="cb1-5"><a href="one-sample-proportion.html#cb1-5" aria-hidden="true" tabindex="-1"></a>prec<span class="fl">.1</span>prop <span class="ot">&lt;-</span> <span class="cf">function</span>(p, <span class="at">n=</span><span class="cn">NULL</span>, <span class="at">se=</span><span class="cn">NULL</span>){</span>
<span id="cb1-6"><a href="one-sample-proportion.html#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(n) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(se)){</span>
<span id="cb1-7"><a href="one-sample-proportion.html#cb1-7" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> p <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p) <span class="sc">/</span> se<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-8"><a href="one-sample-proportion.html#cb1-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(n) <span class="sc">&amp;</span> <span class="fu">is.null</span>(se)){</span>
<span id="cb1-9"><a href="one-sample-proportion.html#cb1-9" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n)</span>
<span id="cb1-10"><a href="one-sample-proportion.html#cb1-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="fu">stop</span>(<span class="st">&quot;Exactly one of &#39;n&#39; and &#39;se&#39; has to be NULL&quot;</span>)</span>
<span id="cb1-11"><a href="one-sample-proportion.html#cb1-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-12"><a href="one-sample-proportion.html#cb1-12" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> p, <span class="at">n =</span> n, <span class="at">se =</span> se)</span>
<span id="cb1-13"><a href="one-sample-proportion.html#cb1-13" aria-hidden="true" tabindex="-1"></a>  res</span>
<span id="cb1-14"><a href="one-sample-proportion.html#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="power-based-sample-size-1" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Power-based sample size<a href="one-sample-proportion.html#power-based-sample-size-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The sample size can also be based on the power to test, at a significance level <span class="math inline">\(\alpha\)</span>, the null hypothesis <span class="math inline">\(H_0: p = p_0\)</span> versus the two-sided alternative <span class="math inline">\(H_{a1}: p \neq p_0\)</span>, or the one-sided alternatives <span class="math inline">\(H_{a2}: p &gt; p_0\)</span> or <span class="math inline">\(H_{a3}: p &lt; p_0\)</span>.</p>
<div id="test-statistic-1" class="section level3 unnumbered hasAnchor">
<h3>Test statistic<a href="one-sample-proportion.html#test-statistic-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are three commonly used tests:</p>
<ol style="list-style-type: decimal">
<li><strong>Exact binomial test</strong> with test statistic <span class="math inline">\(X = \sum_{i=1}^n X_i \sim Binom(n,p_0)\)</span> under <span class="math inline">\(H_0\)</span></li>
<li>One-sample <strong>Wald z-test</strong> with test statistic <span class="math inline">\(Z_W = \frac{\hat{p} - p_0}{\sqrt{\hat{p}(1-\hat{p})/n}} \approx N(0,1)\)</span> under <span class="math inline">\(H_0\)</span></li>
<li>One-sample <strong>Score z-test</strong> with test statistic <span class="math inline">\(Z_S = \frac{\hat{p} - p_0}{\sqrt{p_0(1-p_0)/n}} \approx N(0,1)\)</span> under <span class="math inline">\(H_0\)</span></li>
</ol>
<p>Table (#tab:oneprop-rejection) Rejection regions for the tests</p>
<table>
<colgroup>
<col width="21%" />
<col width="28%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Test</th>
<th align="center"><span class="math inline">\(H_{a1}: p \neq p_0\)</span></th>
<th align="center"><span class="math inline">\(H_{a2}: p &gt; p_0\)</span></th>
<th align="center"><span class="math inline">\(H_{a3}: p &lt; p_0\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Exact binomial</td>
<td align="center"><span class="math inline">\(X \geq b_{\frac{\alpha}{2}; n,p_0}\)</span> or <span class="math inline">\(X \leq b_{1-\frac{\alpha}{2}; n,p_0}\)</span></td>
<td align="center"><span class="math inline">\(X \geq b_{\alpha; n,p_0}\)</span></td>
<td align="center"><span class="math inline">\(X \leq b_{1-\alpha; n,p_0}\)</span></td>
</tr>
<tr class="even">
<td align="left">Wald z-test</td>
<td align="center"><span class="math inline">\(|Z_W| \geq z_\frac{\alpha}{2}\)</span></td>
<td align="center"><span class="math inline">\(Z_W \geq z_\alpha\)</span></td>
<td align="center"><span class="math inline">\(Z_W \leq -z_{\alpha}\)</span></td>
</tr>
<tr class="odd">
<td align="left">Score z-test</td>
<td align="center"><span class="math inline">\(|Z_S| \geq z_\frac{\alpha}{2}\)</span></td>
<td align="center"><span class="math inline">\(Z_S \geq z_\alpha\)</span></td>
<td align="center"><span class="math inline">\(Z_S \leq -z_{\alpha}\)</span></td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(b_{\alpha; n,p_0}\)</span> is the upper <span class="math inline">\(\alpha\)</span>th quantile of the <span class="math inline">\(Binomial(n,p_0)\)</span> distribution, and <span class="math inline">\(z_{\alpha}\)</span> is the upper <span class="math inline">\(\alpha\)</span>th quantile of the <span class="math inline">\(N(0,1)\)</span> distribution.</p>
</div>
<div id="power-formula-1" class="section level3 unnumbered hasAnchor">
<h3>Power formula<a href="one-sample-proportion.html#power-formula-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The power for a specific alternative <span class="math inline">\(p=p_1\)</span> are shown for the one-sided alternative hypothesis <span class="math inline">\(H_{a2}\)</span>. The formula for <span class="math inline">\(H_{a3}\)</span> is a straightforward modification, while the power for the two-sided hypothesis is the sum of the powers for the two one-sided hypotheses using <span class="math inline">\(\alpha/2\)</span> instead of <span class="math inline">\(\alpha\)</span>.</p>
<p>Table (#tab:oneprop-power) Power for the tests</p>
<table>
<colgroup>
<col width="29%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Test</th>
<th align="center">Prob(rejecting <span class="math inline">\(H_0\)</span> versus <span class="math inline">\(H_{a2}\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Exact binomial</td>
<td align="center"><span class="math inline">\(1 - F_{B(n,p_1)}(b_{\frac{\alpha}{2}; n,p_0})\)</span></td>
</tr>
<tr class="even">
<td align="left">Wald z-test</td>
<td align="center"><span class="math inline">\(1 - \Phi\Big(z_\alpha - \frac{p_1 - p_0}{\sqrt{p_1(1-p_1)/n}}\Big)\)</span></td>
</tr>
<tr class="odd">
<td align="left">Score z-test</td>
<td align="center"><span class="math inline">\(1 - \Phi\Big(z_\alpha \sqrt{\frac{p_0(1-p_0)}{p_1(1-p_1)}} - \frac{p_1 - p_0}{\sqrt{p_1(1-p_1)/n}}\Big)\)</span></td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(F_{B(n,p)}\)</span> is the cdf of the <span class="math inline">\(Binomial(n,p)\)</span> distribution, and <span class="math inline">\(\Phi\)</span> is the cdf of the <span class="math inline">\(N(0,1)\)</span> distribution.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="one-sample-proportion.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Calculate power for given sample size, or vice versa. Exactly one of &#39;n&#39; and &#39;power&#39; has to be NULL</span></span>
<span id="cb2-2"><a href="one-sample-proportion.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; p0 - null hypothesis event probability</span></span>
<span id="cb2-3"><a href="one-sample-proportion.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; p1 - alternative hypothesis event probability</span></span>
<span id="cb2-4"><a href="one-sample-proportion.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; n - sample size</span></span>
<span id="cb2-5"><a href="one-sample-proportion.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; power - power to reject the null hypothesis</span></span>
<span id="cb2-6"><a href="one-sample-proportion.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; sig.level - significance level of test</span></span>
<span id="cb2-7"><a href="one-sample-proportion.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; alternative - type of alternative hypothesis</span></span>
<span id="cb2-8"><a href="one-sample-proportion.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; test - type of test</span></span>
<span id="cb2-9"><a href="one-sample-proportion.html#cb2-9" aria-hidden="true" tabindex="-1"></a>power<span class="fl">.1</span>prop.test <span class="ot">&lt;-</span> <span class="cf">function</span>(p0, p1, <span class="at">n=</span><span class="cn">NULL</span>, <span class="at">power=</span><span class="cn">NULL</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>, </span>
<span id="cb2-10"><a href="one-sample-proportion.html#cb2-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">&quot;less&quot;</span>,<span class="st">&quot;greater&quot;</span>,<span class="st">&quot;two.sided&quot;</span>),</span>
<span id="cb2-11"><a href="one-sample-proportion.html#cb2-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">test =</span> <span class="fu">c</span>(<span class="st">&quot;Wald&quot;</span>,<span class="st">&quot;score&quot;</span>,<span class="st">&quot;binomial&quot;</span>)){</span>
<span id="cb2-12"><a href="one-sample-proportion.html#cb2-12" aria-hidden="true" tabindex="-1"></a>  alternative <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(alternative)</span>
<span id="cb2-13"><a href="one-sample-proportion.html#cb2-13" aria-hidden="true" tabindex="-1"></a>  sides <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(alternative<span class="sc">==</span><span class="st">&quot;two.sided&quot;</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb2-14"><a href="one-sample-proportion.html#cb2-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-15"><a href="one-sample-proportion.html#cb2-15" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(test)</span>
<span id="cb2-16"><a href="one-sample-proportion.html#cb2-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-17"><a href="one-sample-proportion.html#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (test <span class="sc">==</span> <span class="st">&quot;binomial&quot;</span>){</span>
<span id="cb2-18"><a href="one-sample-proportion.html#cb2-18" aria-hidden="true" tabindex="-1"></a>    p.body.up <span class="ot">&lt;-</span> <span class="fu">quote</span>({</span>
<span id="cb2-19"><a href="one-sample-proportion.html#cb2-19" aria-hidden="true" tabindex="-1"></a>      ba <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(sig.level<span class="sc">/</span>sides, <span class="at">size =</span> n, <span class="at">prob=</span>p0, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-20"><a href="one-sample-proportion.html#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pbinom</span>(ba, <span class="at">size=</span>n, <span class="at">prob=</span>p1, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)})</span>
<span id="cb2-21"><a href="one-sample-proportion.html#cb2-21" aria-hidden="true" tabindex="-1"></a>    p.body.lo <span class="ot">&lt;-</span> <span class="fu">quote</span>({</span>
<span id="cb2-22"><a href="one-sample-proportion.html#cb2-22" aria-hidden="true" tabindex="-1"></a>      ba <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(sig.level<span class="sc">/</span>sides, <span class="at">size =</span> n, <span class="at">prob=</span>p0, <span class="at">lower.tail=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-23"><a href="one-sample-proportion.html#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pbinom</span>(ba, <span class="at">size=</span>n, <span class="at">prob=</span>p1, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)})</span>
<span id="cb2-24"><a href="one-sample-proportion.html#cb2-24" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-25"><a href="one-sample-proportion.html#cb2-25" aria-hidden="true" tabindex="-1"></a>    za <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(sig.level<span class="sc">/</span>sides, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-26"><a href="one-sample-proportion.html#cb2-26" aria-hidden="true" tabindex="-1"></a>    vratio <span class="ot">&lt;-</span> <span class="cf">if</span> (test <span class="sc">==</span> <span class="st">&quot;score&quot;</span>){ <span class="fu">sqrt</span>(p0 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p0) <span class="sc">/</span> (p1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p1)))} <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb2-27"><a href="one-sample-proportion.html#cb2-27" aria-hidden="true" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> (p0 <span class="sc">-</span> p1)<span class="sc">/</span><span class="fu">sqrt</span>(p1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p1)) </span>
<span id="cb2-28"><a href="one-sample-proportion.html#cb2-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-29"><a href="one-sample-proportion.html#cb2-29" aria-hidden="true" tabindex="-1"></a>    p.body.up  <span class="ot">&lt;-</span> <span class="fu">quote</span>({</span>
<span id="cb2-30"><a href="one-sample-proportion.html#cb2-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pnorm</span>(za <span class="sc">*</span> vratio <span class="sc">+</span> delta <span class="sc">*</span> <span class="fu">sqrt</span>(n), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-31"><a href="one-sample-proportion.html#cb2-31" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb2-32"><a href="one-sample-proportion.html#cb2-32" aria-hidden="true" tabindex="-1"></a>    p.body.lo  <span class="ot">&lt;-</span> <span class="fu">quote</span>({</span>
<span id="cb2-33"><a href="one-sample-proportion.html#cb2-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pnorm</span>(<span class="sc">-</span>za <span class="sc">*</span> vratio <span class="sc">+</span> delta <span class="sc">*</span> <span class="fu">sqrt</span>(n), <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-34"><a href="one-sample-proportion.html#cb2-34" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb2-35"><a href="one-sample-proportion.html#cb2-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-36"><a href="one-sample-proportion.html#cb2-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-37"><a href="one-sample-proportion.html#cb2-37" aria-hidden="true" tabindex="-1"></a>  p.body <span class="ot">&lt;-</span> <span class="cf">if</span> (alternative<span class="sc">==</span><span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb2-38"><a href="one-sample-proportion.html#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">call</span>(<span class="st">&quot;+&quot;</span>, p.body.lo, p.body.up)</span>
<span id="cb2-39"><a href="one-sample-proportion.html#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (alternative<span class="sc">==</span><span class="st">&quot;greater&quot;</span>)</span>
<span id="cb2-40"><a href="one-sample-proportion.html#cb2-40" aria-hidden="true" tabindex="-1"></a>    p.body.up</span>
<span id="cb2-41"><a href="one-sample-proportion.html#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> </span>
<span id="cb2-42"><a href="one-sample-proportion.html#cb2-42" aria-hidden="true" tabindex="-1"></a>    p.body.lo</span>
<span id="cb2-43"><a href="one-sample-proportion.html#cb2-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-44"><a href="one-sample-proportion.html#cb2-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-45"><a href="one-sample-proportion.html#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(power) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(n)){</span>
<span id="cb2-46"><a href="one-sample-proportion.html#cb2-46" aria-hidden="true" tabindex="-1"></a>    power <span class="ot">&lt;-</span> <span class="fu">eval</span>(p.body)</span>
<span id="cb2-47"><a href="one-sample-proportion.html#cb2-47" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(power) <span class="sc">&amp;</span> <span class="fu">is.null</span>(n)){</span>
<span id="cb2-48"><a href="one-sample-proportion.html#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (test <span class="sc">==</span> <span class="st">&quot;binomial&quot;</span>){</span>
<span id="cb2-49"><a href="one-sample-proportion.html#cb2-49" aria-hidden="true" tabindex="-1"></a>      n <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-50"><a href="one-sample-proportion.html#cb2-50" aria-hidden="true" tabindex="-1"></a>      found <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb2-51"><a href="one-sample-proportion.html#cb2-51" aria-hidden="true" tabindex="-1"></a>      <span class="cf">while</span> (<span class="sc">!</span>found <span class="sc">&amp;</span> n <span class="sc">&lt;=</span> <span class="fl">1e+7</span>){</span>
<span id="cb2-52"><a href="one-sample-proportion.html#cb2-52" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> n<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb2-53"><a href="one-sample-proportion.html#cb2-53" aria-hidden="true" tabindex="-1"></a>        pw <span class="ot">&lt;-</span> <span class="fu">eval</span>(p.body)</span>
<span id="cb2-54"><a href="one-sample-proportion.html#cb2-54" aria-hidden="true" tabindex="-1"></a>        found <span class="ot">&lt;-</span> (pw <span class="sc">&gt;=</span> power) </span>
<span id="cb2-55"><a href="one-sample-proportion.html#cb2-55" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb2-56"><a href="one-sample-proportion.html#cb2-56" aria-hidden="true" tabindex="-1"></a>      power <span class="ot">&lt;-</span> pw</span>
<span id="cb2-57"><a href="one-sample-proportion.html#cb2-57" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb2-58"><a href="one-sample-proportion.html#cb2-58" aria-hidden="true" tabindex="-1"></a>      n <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(n) <span class="fu">eval</span>(p.body) <span class="sc">-</span> power, <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1e+07</span>), </span>
<span id="cb2-59"><a href="one-sample-proportion.html#cb2-59" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tol =</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.25</span>, <span class="at">extendInt =</span> <span class="st">&quot;upX&quot;</span>)<span class="sc">$</span>root</span>
<span id="cb2-60"><a href="one-sample-proportion.html#cb2-60" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-61"><a href="one-sample-proportion.html#cb2-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-62"><a href="one-sample-proportion.html#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="one-sample-proportion.html#cb2-63" aria-hidden="true" tabindex="-1"></a>  METHOD <span class="ot">&lt;-</span> <span class="fu">paste</span>(</span>
<span id="cb2-64"><a href="one-sample-proportion.html#cb2-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(test, <span class="at">Wald =</span> <span class="st">&quot;Wald z&quot;</span>, <span class="at">score =</span> <span class="st">&quot;Score z&quot;</span>, <span class="at">binomial =</span> <span class="st">&quot;Exact binomial&quot;</span>),</span>
<span id="cb2-65"><a href="one-sample-proportion.html#cb2-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;test power calculation&quot;</span>)</span>
<span id="cb2-66"><a href="one-sample-proportion.html#cb2-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-67"><a href="one-sample-proportion.html#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">structure</span>(<span class="fu">list</span>(<span class="at">n =</span> n, <span class="at">p0 =</span> p0, <span class="at">p1 =</span> p1, <span class="at">sig.level =</span> sig.level, </span>
<span id="cb2-68"><a href="one-sample-proportion.html#cb2-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">power =</span> power, <span class="at">alternative =</span> alternative, <span class="at">note =</span> <span class="st">&quot;n is the number of independent samples&quot;</span>, </span>
<span id="cb2-69"><a href="one-sample-proportion.html#cb2-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> METHOD), <span class="at">class =</span> <span class="st">&quot;power.htest&quot;</span>)</span>
<span id="cb2-70"><a href="one-sample-proportion.html#cb2-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-71"><a href="one-sample-proportion.html#cb2-71" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="getting-inputs-worstbest-case-scenarios" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Getting inputs, worst/best case scenarios<a href="one-sample-proportion.html#getting-inputs-worstbest-case-scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="example-revisited-1" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Example revisited<a href="one-sample-proportion.html#example-revisited-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="simulation-study-1" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Simulation study<a href="one-sample-proportion.html#simulation-study-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="functions-in-r-packages-1" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Functions in R packages<a href="one-sample-proportion.html#functions-in-r-packages-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="one-sample-mean.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
